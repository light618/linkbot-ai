# 抖音白名单授权说明

## 🔍 问题说明

主公，您遇到的"用户未绑定应用白名单"提示是正常的。抖音开放平台要求：

**必须先进行白名单授权，然后才能进行用户授权**

## 📋 授权流程（两步）

### 第一步：白名单授权（必需）

1. **访问白名单授权地址**：
   ```
   http://localhost:8080/oauth/douyin/whitelist
   ```
   或者在前端点击"先进行白名单授权"按钮

2. **扫码授权**：
   - 使用抖音APP扫描二维码
   - 授权 `trial.whitelist` 权限
   - 授权成功后，页面会显示"白名单授权成功"

3. **完成提示**：
   - 看到"白名单授权成功"后，可以关闭页面
   - 这一步只需要做一次

### 第二步：用户授权

1. **访问用户授权地址**：
   - 在前端点击"抖音扫码授权"
   - 或直接访问：`http://localhost:8080/oauth/douyin`

2. **扫码授权**：
   - 使用抖音APP扫描二维码
   - 授权以下权限：
     - `user_info` - 用户信息
     - `video.list` - 视频列表
     - `video.comment` - 视频评论

3. **授权成功**：
   - 页面会显示授权成功信息
   - 自动获取 access_token
   - 账号信息会自动保存

## 🚀 快速操作

### 方法一：通过前端界面

1. 进入"渠道中心" → "抖音接入"
2. 点击"抖音扫码授权"
3. 在弹窗中点击"先进行白名单授权"
4. 完成白名单授权后，再扫描二维码进行用户授权

### 方法二：直接访问URL

**白名单授权**：
```
http://localhost:8080/oauth/douyin/whitelist
```

**用户授权**：
```
http://localhost:8080/oauth/douyin
```

## ⚠️ 注意事项

1. **白名单授权只需一次**：完成白名单授权后，后续只需要进行用户授权
2. **授权顺序不能颠倒**：必须先白名单，后用户授权
3. **如果跳过白名单授权**：会提示"用户未绑定应用白名单"
4. **授权有效期**：access_token 通常有效期为 2 小时，过期后需要重新授权

## 🔧 代码实现

Go服务已经实现了两个授权接口：

- `/oauth/douyin/whitelist` - 白名单授权（scope: trial.whitelist）
- `/oauth/douyin` - 用户授权（scope: user_info,video.list,video.comment）

前端已更新，会引导用户先进行白名单授权。

## 📝 总结

主公，这是抖音开放平台的正常流程：
1. ✅ 先进行白名单授权（一次即可）
2. ✅ 然后进行用户授权（每次需要时）
3. ✅ 授权成功后即可开始监听和回复

现在前端已经更新，会引导您完成正确的授权流程。

